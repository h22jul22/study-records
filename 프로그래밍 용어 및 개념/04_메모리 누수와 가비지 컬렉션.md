### 메모리 누수

-   메모리 공간에 불필요한 데이터가 쌓여서 남아있는 것
-   프로그램이 계속해서 작동하기 위해서는 다 쓴 데이터를 그때그때 치워주어야 한다. 그렇지 않으면 런타임 오류로 이어진다.
    > 런타임 오류란? 프로그램 실행 중, 즉 런타임에 발생하는 오류이다.

### 가비지 컬렉션

-   C 언어와 C++ 같은 언매니지드 언어에서는 다 쓴 메모리를 개발자가 일일이 치워주어야 한다.
-   하지만 자바나 파이썬, 자바스크립트를 비롯한 현대적인 언어에서는 이 메모리 관리를 상당 부분 자동으로 처리해 주는 기능이 있는데, 이를 쓰레기 수집 또는 **가비지 컬렉션**이라고 한다.
-   메모리 위의 데이터 중에 사용할 일이 없는 데이터를 컴퓨터가 판단해서 주기적으로 치워주는 것이다.
-   카비지 컬렉션 덕분에 개발자는 메모리를 크게 신경 쓰지 않아도 문제 없이 프로그래밍 할 수 있게 되었다.
-   가비지 컬렉션의 한계
    -   가비지 컬렉션은 프로그램이 동작하는 도중 **불특정 시점에 실행**되는데, 이때 언어의 쓰레기 수집 방식에 따라 **프로그램이 부분적으로 혹은 전체적으로 중단**된다.
    -   어떤 데이터가 더이상 사용되지 않을지 또한 컴퓨터가 판단해야 하므로 연산에 시간이 소요되기 때문이다.
    -   불필요한 데이터를 모두 제거하지 못한다. 소스 코드상의 어떤 요소는 컴퓨터가 비워도 되는 데이터로 인지하지 못하고 남겨두는 경우가 있다. 즉 **가비지 컬렉터를 사용해도 메모리 누수가 생길 수 있다**는 것이다.
    -   그렇기 때문에 가비지 컬렉션을 지원하는 매니지드 언어를 사용하더라도 가비지 컬렉션에 전적으로 의존하면 안 된다.

### 자바스크립트 가비지 컬렉터

-   자바스크립트는 매니지드 언어로, 메모리를 자동으로 관리하는 가비지 컬렉터를 가지고 있다.
-   가비지 컬렉션 기준
    -   자바스크립트는 *도달 가능성(reachability)* 이라는 개념을 사용해 메모리 관리를 수행한다.
        1. ‘도달 가능한(reachable)’ 값은 쉽게 말해 어떻게든 접근하거나 사용할 수 있는 값을 의미한다. 도달 가능한 값은 메모리에서 삭제되지 않는다.

            > 예시:
            >
            > - 현재 함수의 지역 변수와 매개변수
            > - 중첩 함수의 체인에 있는 함수에서 사용되는 변수와 매개변수
            > - 전역 변수
            > - 기타 등등
            >
            > 이런 값은 *루트(root)* 라고 부릅니다.

        2. 루트가 참조하는 값이나 체이닝으로 루트에서 참조할 수 있는 값은 도달 가능한 값이 된다.

            > 전역 변수에 객체가 저장되어있다고 가정해 봅시다. 이 객체의 프로퍼티가 또 다른 객체를 참조하고 있다면, 프로퍼티가 참조하는 객체는 도달 가능한 값이 됩니다. 이 객체가 참조하는 다른 모든 것들도 도달 가능하다고 여겨집니다.
    -   자바스크립트 엔진 내에선 가비지 컬렉터가 끊임없이 동작한다. 가비지 컬렉터는 모든 객체를 모니터링하고, 도달할 수 없는 객체는 삭제한다.
-   내부 알고리즘
    -   대부분의 JS 엔진에서는 'mark-and-sweep’ 알고리즘을 사용하여 가비지 컬렉션을 수행한다.
        > 'mark-and-sweep’이라 불리는 가비지 컬렉션 기본 알고리즘에 대해 알아봅시다.
        > '가비지 컬렉션’은 대개 다음 단계를 거쳐 수행됩니다.
        >
        > -   가비지 컬렉터는 루트(root) 정보를 수집하고 이를 ‘mark(기억)’ 합니다.
        > -   루트가 참조하고 있는 모든 객체를 방문하고 이것들을 ‘mark’ 합니다.
        > -   mark 된 모든 객체에 방문하고 *그 객체들이* 참조하는 객체도 mark 합니다. 한번 방문한 객체는 전부 mark 하기 때문에 같은 객체를 다시 방문하는 일은 없습니다.
        > -   루트에서 도달 가능한 모든 객체를 방문할 때까지 위 과정을 반복합니다.
        > -   mark 되지 않은 모든 객체를 메모리에서 삭제합니다.
    -   루트에서 페인트를 들이붓는다고 상상하면 이 과정을 이해하기 쉽다. 루트를 시작으로 참조를 따라가면서 도달가능한 객체 모두에 페인트가 칠해진다고 생각하면 된다. 이때 페인트가 묻지 않은 객체는 메모리에서 삭제된다.
